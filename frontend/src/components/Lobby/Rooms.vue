<template>
    <div class="Rooms RoundBorder">
        <div class="FilterArea">
            <div class="FilterOptionArea">
                <div class="PasswordRequired">
                    <select v-model="filterPasswordRequired" style="font-size: 14pt" @change="applyFilter">
                        <option value="all">전체</option>
                        <option value="required">필요</option>
                        <option value="not_required">불필요</option>
                    </select>
                </div>
                <div class="Round">
                    <select v-model="filterRound" name="FilterRound" style="font-size: 14pt" @change="applyFilter">
                        <option value="all">전체</option>
                        <option value="round_10">10 라운드</option>
                        <option value="round_15">15 라운드</option>
                        <option value="round_20">20 라운드</option>
                    </select>
                </div>
                <div class="ShowScore">
                    <select v-model="filterShowScore" name="FilterShowScore" style="font-size: 14pt" @change="applyFilter">
                        <option value="all">전체</option>
                        <option value="show">표시</option>
                        <option value="not_show">미표시</option>
                    </select>
                </div>
                <input class="SearchInput" type="search" placeholder="검색할 방 이름 입력" v-model="filterName" v-on:input="applyFilter"/>
            </div>
            <div class="BtnRefresh" v-on:click="btnRefreshClicked">
                <img src="../../assets/images/icon_refresh.png" style="width: 32px; height: 32px;" />
            </div>
        </div>
        <div class="RoomList">
            <div :class="roomInfo.room_state === '대기중'? 'RoomInfo Enable':'RoomInfo Disable'" v-for="roomInfo in filteredRoomList" v-on:click="onRoomClicked(roomInfo)">
                <div class="RoomInfo1">
                    <img v-if="roomInfo.roomopt_lock" class="Lock" src="../../assets/images/icon_lock.png"/>
                    <label class="Name">{{roomInfo.room_name}}</label>
                    <label class="Player">{{roomInfo.room_current_player}} / {{roomInfo.roomopt_max_player}}</label>
                </div>
                <div class="RoomInfo2">
                    <label class="Round">{{roomInfo.roomopt_round}} 라운드</label>
                    <label v-if="roomInfo.roomopt_show_score" class="ShowScore">점수표시</label>
                    <label v-if="roomInfo.room_state === '대기중'" class="Waiting">{{roomInfo.room_state}}</label>
                    <label v-else-if="roomInfo.room_state === '진행중'" class="Playing">{{roomInfo.room_state}}</label>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
export default {
    name: 'Rooms',
    data() {
        return {
            filterPasswordRequired: 'all',
            filterRound: 'all',
            filterShowScore: 'all',
            filterName: '', 
            filteredRoomList: [],
            roomList: [],
        }
    },
    methods: {
        setRooms(roomList) {
            this.roomList = roomList;
            this.filteredRoomList = this.roomList;
            this.applyFilter();
        },
        applyFilter(){
            this.filteredRoomList = [];
            if(this.filterPasswordRequired == "all") {
                this.filteredRoomList = this.roomList;
            } else if(this.filterPasswordRequired == "required") {
                this.filteredRoomList = this.roomList.filter(roomInfo => roomInfo.roomopt_lock)
            } else if(this.filterPasswordRequired == "not_required") {
                this.filteredRoomList = this.roomList.filter(roomInfo => !roomInfo.roomopt_lock)
            }

            if(this.filterRound == "all") {
                this.filteredRoomList = this.filteredRoomList;
            } else if(this.filterRound == "round_10") {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => roomInfo.roomopt_round == 10)
            } else if(this.filterRound == "round_15") {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => roomInfo.roomopt_round == 15)
            } else if(this.filterRound == "round_20") {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => roomInfo.roomopt_round == 20)
            }

            if(this.filterShowScore == "all") {
                this.filteredRoomList = this.filteredRoomList;
            } else if(this.filterShowScore == "show") {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => roomInfo.roomopt_show_score)
            } else if(this.filterShowScore == "not_show") {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => !roomInfo.roomopt_show_score)
            }

            if(this.filterName == "") {
                this.filteredRoomList = this.filteredRoomList;
            } else {
                this.filteredRoomList = this.filteredRoomList.filter(roomInfo => roomInfo.room_name.indexOf(this.filterName) == 0);
            }
        },
        btnRefreshClicked() {

        },
        onRoomClicked(roomInfo) {
            if(roomInfo.room_state == "진행중") {
                alert("이미 게임이 진행중인 방입니다!");
            }
        },
    },
    mounted() {

    },
}
</script>

<style scoped>
.Rooms {
    background-color: #F9F6F6;
    width: 640px;
    height: 674px;
    margin-left: 32px;
    margin-right: 32px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.RoundBorder {
    border-radius: 8px;
}

.FilterArea {
    box-sizing: border-box;
    width: 622px;
    height: 40px;
    margin: 8px;
    display: flex;
}

.RoomList {
    width: 622px;
    flex: 1;
    margin: 0px 8px 8px 8px;
    overflow: auto;
}
.FilterOptionArea {
    flex: 1;
    margin-right: 8px;
    display: flex;
    align-items: center;
}

.FilterOptionArea .PasswordRequired {
    margin-right: 8px;
}

.FilterOptionArea .Round {
    margin-right: 8px;
}

.FilterOptionArea .ShowScore {
    margin-right: 8px;
}

.FilterOptionArea .SearchInput {
    flex: 1;
    font-size: 14pt;
}

.BtnRefresh {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background-color: #A8A8A8;
    box-shadow: 2px 2px rgb(209, 209, 209);
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
}

.BtnRefresh:hover {
    background-color: #8f8f8f;
}

.BtnRefresh:active {
    background-color: #727272;
}

.RoomInfo {
    padding: 8px;
    display: flexbox;
    border-radius: 8px;
    margin: 8px 8px 0px 4px;
    flex-direction: column;
}

.Enable{
    background-color: #ffffff;
    box-shadow: 2px 2px rgb(209, 209, 209);
}

.Disable{
    user-select: none;
    pointer-events: none;
    background-color: #888888;
    box-shadow: 2px 2px rgb(70, 70, 70);
    opacity: 0.7;
}

.RoomInfo:hover {
    background-color: #e7e7e7;
}

.RoomInfo:active {
    background-color: #c7c7c7;
}

.RoomInfo1 {
    flex: 1;
    display: flex;
    align-items: center;
}

.RoomInfo1 .Lock {
    width: 24px;
    height: 24px;
    user-select: none;
}

.RoomInfo1 .Name {
    flex: 1;
    font-weight: bold;
    font-size: 16pt;
    user-select: none;
}

.RoomInfo1 .Player {
    font-weight: bold;
    font-size: 14pt;
    user-select: none;
}

.RoomInfo2 {
    flex: 1;
    margin-top: 8px;
    align-items: center;
}

.RoomInfo .Round {
    display: inline-block;
    background-color: #6675FF;
    font-weight: bold;
    font-size: 12pt;
    user-select: none;
    color: #ffffff;
    border-radius: 8px;
    padding: 4px;
    margin-right: 8px;
}

.RoomInfo2 .ShowScore {
    display: inline-block;
    background-color: #FF6A6A;
    font-weight: bold;
    font-size: 12pt;
    user-select: none;
    color: #ffffff;
    border-radius: 8px;
    padding: 4px;
    margin-right: 8px;
}
.RoomInfo2 .Waiting {
    color: #4EF05E;
    font-weight: bold;
    font-size: 14pt;
    user-select: none;
    float:right;
}
.RoomInfo2 .Playing {
    color: #a11414;
    font-weight: bold;
    font-size: 14pt;
    user-select: none;
    float:right;
}
</style>